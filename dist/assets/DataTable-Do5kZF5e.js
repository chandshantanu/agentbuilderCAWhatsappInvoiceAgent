import{r,z as k,s as t}from"./index-Bp_UmaCL.js";function C({config:o}){const[c,g]=r.useState([]),[i,f]=r.useState(0),[j,h]=r.useState(!0),[p,N]=r.useState(""),[d,m]=r.useState(0),[n,S]=r.useState(null),[b,u]=r.useState(1),l=o.pageSize||20,y=r.useCallback(async()=>{if(o.endpoint){h(!0);try{const e={limit:l,offset:d*l};p&&(e.search=p),n&&(e.sort_by=n,e.sort_order=b);const a=(await k.get(o.endpoint,{params:e})).data;g(a.data||a),f(a.total||(a.data||a).length)}catch(e){console.error("DataTable fetch error:",e)}finally{h(!1)}}},[o.endpoint,d,p,n,b,l]);r.useEffect(()=>{y()},[y]);const x=o.columns||(c.length>0?Object.keys(c[0]).filter(e=>e!=="_id"&&e!=="id").slice(0,6).map(e=>({key:e,label:e.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()),sortable:!0})):[]),v=e=>{n===e?u(s=>s===1?-1:1):(S(e),u(1))};return t.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white",children:[o.searchable!==!1&&t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsx("input",{type:"text",placeholder:"Search...",value:p,onChange:e=>{N(e.target.value),m(0)},className:"w-full max-w-sm px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/30"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsx("tr",{className:"border-b border-gray-200 bg-gray-50",children:x.map(e=>t.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>e.sortable!==!1&&v(e.key),children:[e.label,n===e.key&&(b===1?" ▲":" ▼")]},e.key))})}),t.jsx("tbody",{children:j?Array.from({length:5}).map((e,s)=>t.jsx("tr",{className:"border-b border-gray-100",children:x.map(a=>t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"h-4 w-24 bg-gray-100 rounded animate-pulse"})},a.key))},s)):c.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:x.length,className:"px-4 py-8 text-center text-gray-400",children:"No data found"})}):c.map((e,s)=>t.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:x.map(a=>t.jsx("td",{className:"px-4 py-3 text-gray-700",children:String(e[a.key]??"-")},a.key))},e.id||s))})]})}),i>l&&t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200",children:[t.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",d*l+1,"-",Math.min((d+1)*l,i)," of ",i]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>m(e=>Math.max(0,e-1)),disabled:d===0,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 hover:bg-gray-50",children:"Previous"}),t.jsx("button",{onClick:()=>m(e=>e+1),disabled:(d+1)*l>=i,className:"px-3 py-1 text-sm border rounded disabled:opacity-50 hover:bg-gray-50",children:"Next"})]})]})]})}export{C as default};
