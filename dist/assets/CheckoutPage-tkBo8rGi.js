import{u as V,o as W,w as X,q as G,x as H,r as n,y as N,s as e,v as J,F as Q,U as Y,d as ee,X as $}from"./index-Bp_UmaCL.js";import{A as se}from"./arrow-left-BmyiyaPF.js";import{Z as te}from"./zap-DGdwi-Ph.js";import{S as z}from"./shield-AKBPkDLF.js";import{B as ae}from"./bar-chart-3-sG18jGHf.js";import{C as re}from"./clock-BMq5U3Dh.js";import{L as ne,T as B}from"./tag-CoGon6bL.js";import{S as oe}from"./sparkles-yyEVK7tt.js";import{C as le}from"./check-DoRmBi-x.js";import{L as D}from"./loader-2-B7eL5lYw.js";function ie(m){const t=m.replace("#",""),a=parseInt(t.substring(0,2),16),x=parseInt(t.substring(2,4),16),h=parseInt(t.substring(4,6),16);return`${a}, ${x}, ${h}`}function ce(m,t){const a=m.replace("#",""),x=Math.min(255,parseInt(a.substring(0,2),16)+Math.round(255*t)),h=Math.min(255,parseInt(a.substring(2,4),16)+Math.round(255*t)),g=Math.min(255,parseInt(a.substring(4,6),16)+Math.round(255*t));return`#${x.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}${g.toString(16).padStart(2,"0")}`}const q=[te,z,ae,Q,Y,re];function ve(){const{config:m,subdomain:t}=V(),{user:a}=W(),{hasSubscription:x,refetch:h}=X(),g=G(),[R]=H(),[o,v]=n.useState(""),[l,b]=n.useState(null),[w,y]=n.useState(""),[E,j]=n.useState(!1),[A,C]=n.useState(!1),[P,S]=n.useState(""),k=n.useRef(!1);if(n.useEffect(()=>{x&&g("/onboarding")},[x,g]),n.useEffect(()=>{if(k.current)return;const s=R.get("coupon");if(s&&t&&!o){k.current=!0;const r=s.toUpperCase();v(r),j(!0),N.validateCoupon(t,r).then(d=>b(d.data)).catch(d=>y(d.message||"Invalid coupon")).finally(()=>j(!1))}},[R,t,o]),n.useEffect(()=>{if(document.getElementById("razorpay-script"))return;const s=document.createElement("script");s.id="razorpay-script",s.src="https://checkout.razorpay.com/v1/checkout.js",s.async=!0,document.body.appendChild(s)},[]),!m||!t)return null;const{branding:f,pricing:p,landing_page:_}=m,i=f.primary_color||"#2563eb",c=ie(i),L=l?l.final_amount:p.monthly_price,u=(p.currency||"INR")==="INR"?"₹":"$",M=p.display_price||p.monthly_price,F=(_==null?void 0:_.features)||[],T=l?l.discount:0,U=async()=>{if(o.trim()){y(""),j(!0);try{const s=await N.validateCoupon(t,o.trim());b(s.data)}catch(s){y(s.message||"Invalid coupon"),b(null)}finally{j(!1)}}},O=()=>{v(""),b(null),y(""),k.current=!1},Z=async()=>{C(!0),S("");try{const r=(await N.createOrder(t,l?o:void 0)).data,d={key:r.key_id,amount:r.amount*100,currency:r.currency,name:r.brand_name||f.brand_name||t,description:"Monthly Subscription",order_id:r.order_id,prefill:{email:(a==null?void 0:a.email)||""},theme:{color:i},handler:async I=>{try{await N.verifyPayment(t,{razorpay_order_id:I.razorpay_order_id,razorpay_payment_id:I.razorpay_payment_id,razorpay_signature:I.razorpay_signature}),await h(),g("/onboarding")}catch(K){S(K.message||"Payment verification failed")}},modal:{ondismiss:()=>C(!1)}};new window.Razorpay(d).open()}catch(s){S(s.message||"Failed to create order")}finally{C(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50",style:{fontFamily:"'Inter', system-ui, sans-serif"},children:[e.jsx("header",{className:"bg-white border-b border-gray-200/60",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-5 sm:px-8 h-[60px] flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f.logo_url&&e.jsx("img",{src:f.logo_url,alt:"",className:"h-8 w-auto"}),e.jsx("span",{className:"font-semibold text-[17px] text-gray-900 tracking-[-0.01em]",children:f.brand_name||t})]}),e.jsxs(J,{to:"/",className:"flex items-center gap-1.5 text-sm text-gray-500 hover:text-gray-700 transition-colors",children:[e.jsx(se,{className:"w-4 h-4"}),"Back"]})]})}),e.jsx("div",{className:"max-w-5xl mx-auto px-5 sm:px-8 py-10 sm:py-14",children:e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 order-2 lg:order-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-5",children:"What's included"}),e.jsx("div",{className:"space-y-4",children:(F.length>0?F:[{title:"AI-Powered Automation",description:"Smart conversations that convert"},{title:"24/7 Availability",description:"Never miss a lead again"},{title:"Analytics Dashboard",description:"Track performance in real-time"}]).slice(0,6).map((s,r)=>{const d=q[r%q.length];return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center shrink-0 mt-0.5",style:{backgroundColor:`rgba(${c}, 0.08)`},children:e.jsx(d,{className:"w-4 h-4",style:{color:i}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:s.description})]})]},r)})}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-gray-500",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:"256-bit SSL encrypted payments"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-gray-500",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Powered by Razorpay — PCI DSS compliant"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-gray-500",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"Cancel anytime — no questions asked"})]})]})]}),e.jsx("div",{className:"lg:col-span-3 order-1 lg:order-2",children:e.jsxs("div",{className:"relative bg-white rounded-2xl p-7 sm:p-8",style:{border:`1.5px solid rgba(${c}, 0.15)`,boxShadow:`0 1px 3px rgba(0,0,0,0.06), 0 8px 32px rgba(${c}, 0.06)`},children:[p.trial_days>0&&e.jsxs("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 h-[26px] px-4 rounded-full text-xs font-semibold text-white flex items-center gap-1 shadow-md",style:{backgroundColor:i,boxShadow:`0 2px 12px rgba(${c}, 0.4)`},children:[e.jsx(oe,{className:"w-3 h-3"}),p.trial_days,"-day free trial"]}),P&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 rounded-lg p-3 mb-5 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 shrink-0"}),P]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Monthly subscription"}),e.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[e.jsx("span",{className:"text-lg font-medium text-gray-400",children:u}),e.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tight leading-none",children:M}),e.jsx("span",{className:"text-gray-400 text-base font-medium",children:"/mo"})]}),(a==null?void 0:a.email)&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["for ",a.email]})]}),e.jsx("div",{className:"h-px bg-gray-100 mb-6"}),e.jsxs("div",{className:"rounded-xl p-4 mb-5 space-y-2.5",style:{backgroundColor:`rgba(${c}, 0.03)`},children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Monthly plan"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[u,M]})]}),l&&e.jsxs("div",{className:"flex justify-between items-center text-sm text-emerald-600",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(B,{className:"w-3.5 h-3.5"}),"Coupon (",o,")"]}),e.jsxs("span",{className:"font-medium",children:["-",u,T]})]}),e.jsxs("div",{className:"border-t border-gray-200/60 pt-2.5 flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Total due today"}),e.jsxs("span",{className:"text-xl font-bold",style:{color:l?"#059669":i},children:[u,L]})]})]}),l?e.jsxs("div",{className:"flex items-center justify-between bg-emerald-50 rounded-lg px-4 py-3 mb-5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:o})," applied — you save ",u,T]}),e.jsx("button",{onClick:O,className:"text-emerald-600 hover:text-emerald-800 transition-colors",children:e.jsx($,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:o,onChange:s=>{v(s.target.value.toUpperCase()),w&&y("")},onKeyDown:s=>s.key==="Enter"&&U(),className:"w-full pl-9 pr-3 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:border-transparent transition-shadow",style:{"--tw-ring-color":`rgba(${c}, 0.4)`},placeholder:"Coupon code"})]}),e.jsx("button",{onClick:U,disabled:E||!o.trim(),className:"px-5 py-2.5 text-sm font-medium border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:E?e.jsx(D,{className:"w-4 h-4 animate-spin"}):"Apply"})]}),w&&e.jsxs("p",{className:"text-xs text-red-500 mt-1.5 flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"})," ",w]})]}),e.jsx("button",{onClick:Z,disabled:A,className:"w-full h-[52px] rounded-xl text-white font-semibold text-[15px] disabled:opacity-50 flex items-center justify-center gap-2.5 transition-all duration-300 hover:shadow-lg hover:brightness-105 active:scale-[0.99]",style:{background:`linear-gradient(135deg, ${i}, ${ce(i,.12)})`,boxShadow:`0 4px 16px rgba(${c}, 0.3)`},children:A?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-5 h-5"}),"Pay ",u,L,"/month"]})}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-4",children:"Secure payment powered by Razorpay. Cancel anytime."})]})})]})})]})}export{ve as default};
