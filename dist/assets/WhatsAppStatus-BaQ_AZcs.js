import{r as i,z as w,s as e,j as C,i as f,U as y,F as _}from"./index-Bp_UmaCL.js";import{C as d,a as m,c as x,d as N,b as h}from"./card-CF4LKrxb.js";import{B as A}from"./badge-BsIsCzmH.js";import{A as S,a as k,L as T,C as W}from"./link-CUe8ygyv.js";import{Z as L}from"./zap-DGdwi-Ph.js";import{C as M}from"./clock-BMq5U3Dh.js";import{C as B}from"./check-DoRmBi-x.js";import"./index-CvZeWDWn.js";function o({icon:l,label:t,value:n,color:a="text-neutral-600"}){return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-neutral-50/80",children:[e.jsx("div",{className:`p-2 rounded-md bg-white shadow-sm ${a}`,children:e.jsx(l,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs text-neutral-500",children:t}),e.jsx("div",{className:"text-sm font-semibold text-neutral-900 truncate",children:n})]})]})}function F(l){const t=Date.now(),n=new Date(l).getTime(),a=t-n,r=Math.floor(a/6e4);if(r<1)return"Just now";if(r<60)return`${r}m ago`;const s=Math.floor(r/60);return s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`}function Z({config:l}){const[t,n]=i.useState(!1),[a,r]=i.useState(!0),[s,u]=i.useState(null),[v,p]=i.useState(!1);i.useEffect(()=>{w.get("/api/whatsapp/status").then(g=>{const j=g.data||g;u(j),n(!!j.connected)}).catch(()=>n(!1)).finally(()=>r(!1))},[]);const b=()=>{s!=null&&s.webhook_url&&(navigator.clipboard.writeText(s.webhook_url),p(!0),setTimeout(()=>p(!1),2e3))},c=s==null?void 0:s.message_stats;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-green-600"}),"WhatsApp Business Connection",!a&&e.jsx(A,{variant:t?"default":"destructive",className:t?"bg-green-600 hover:bg-green-700":"",children:t?"Connected":"Not Connected"})]}),e.jsx(N,{children:t?"Your WhatsApp Business number is actively receiving and processing invoices.":"Connect your WhatsApp Business number to start processing invoices automatically."})]}),e.jsx(h,{children:a?e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-neutral-200 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-neutral-200 rounded w-1/2"})]}):t&&s?e.jsxs("div",{className:"grid grid-cols-2 gap-4 max-w-lg",children:[e.jsx("span",{className:"text-sm text-neutral-500",children:"Phone Number"}),e.jsx("span",{className:"text-sm font-medium",children:s.phone_number}),s.verified_name&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-neutral-500",children:"Business Name"}),e.jsx("span",{className:"text-sm font-medium",children:s.verified_name})]}),s.connected_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-neutral-500",children:"Connected Since"}),e.jsx("span",{className:"text-sm font-medium",children:new Date(s.connected_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]}),s.phone_number_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-neutral-500",children:"Phone Number ID"}),e.jsx("span",{className:"text-sm font-mono text-xs text-neutral-600",children:s.phone_number_id})]})]}):e.jsxs("div",{className:"text-sm text-neutral-500 space-y-2",children:[e.jsx("p",{children:"To connect, complete the WhatsApp Embedded Signup from the agent configuration wizard."}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Once connected, your clients can send invoice photos or PDFs directly to your WhatsApp Business number."})]})})]}),t&&c&&e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2 text-base",children:[e.jsx(f,{className:"h-4 w-4"}),"Message Activity"]})}),e.jsxs(h,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[e.jsx(o,{icon:f,label:"Total Messages",value:c.total,color:"text-blue-600"}),e.jsx(o,{icon:S,label:"Received",value:c.incoming,color:"text-green-600"}),e.jsx(o,{icon:k,label:"Sent",value:c.outgoing,color:"text-violet-600"}),e.jsx(o,{icon:y,label:"Unique Senders",value:c.unique_senders,color:"text-amber-600"}),e.jsx(o,{icon:L,label:"Today",value:c.today,color:"text-rose-600"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-6 text-sm text-neutral-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-neutral-900",children:(s==null?void 0:s.total_invoices)??0})," ","invoices processed"]})]}),(s==null?void 0:s.last_received)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsxs("span",{children:["Last message"," ",e.jsx("strong",{className:"text-neutral-900",children:F(s.last_received)})]})]})]})]})]}),t&&(s==null?void 0:s.webhook_url)&&e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-base",children:[e.jsx(T,{className:"h-4 w-4"}),"Webhook Configuration"]}),e.jsx(N,{children:"This webhook URL is configured in your Meta App to receive WhatsApp messages."})]}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 px-3 py-2 bg-neutral-100 rounded-md text-sm font-mono text-neutral-700 truncate",children:s.webhook_url}),e.jsx("button",{onClick:b,className:"p-2 rounded-md hover:bg-neutral-100 transition-colors text-neutral-500",title:"Copy webhook URL",children:v?e.jsx(B,{className:"h-4 w-4 text-green-600"}):e.jsx(W,{className:"h-4 w-4"})})]})})]})]})}export{Z as default};
