import{r as a,s as e,D as g}from"./index-Bp_UmaCL.js";import{u as I,L as r,S as N,a as y,b as f,c as b,d as n}from"./select-Crm1tiLE.js";import{I as u,B as C}from"./input-GzHbweEW.js";import{c as p}from"./caInvoiceService-09kBxQwV.js";import{F as V,a as A}from"./file-spreadsheet-CaK8s0SI.js";import"./index-CvZeWDWn.js";function S(h,i,c){const d=new Blob([h],{type:c}),l=URL.createObjectURL(d),s=document.createElement("a");s.href=l,s.download=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}function G({config:h}){const{toast:i}=I(),[c,d]=a.useState([]),[l,s]=a.useState(!1),[o,w]=a.useState(""),[x,E]=a.useState(""),[m,T]=a.useState(""),[v,_]=a.useState("approved"),[j,D]=a.useState("");a.useEffect(()=>{p.listClients({limit:200}).then(t=>{d(t.data||[])})},[]);const L=async()=>{s(!0);try{const t=await p.exportTally({client_id:o||void 0,date_from:x||void 0,date_to:m||void 0,status:v||void 0,tally_company:j||void 0});S(t.xml,`tally-export-${Date.now()}.xml`,"application/xml"),i({title:`Exported ${t.invoice_count} invoices to Tally XML`})}catch(t){i({title:"Export failed",description:t.message,variant:"destructive"})}finally{s(!1)}},F=async()=>{s(!0);try{const t=await p.exportCsv({client_id:o||void 0,date_from:x||void 0,date_to:m||void 0});S(t.csv,`invoices-export-${Date.now()}.csv`,"text/csv"),i({title:`Exported ${t.invoice_count} invoices to CSV`})}catch(t){i({title:"Export failed",description:t.message,variant:"destructive"})}finally{s(!1)}};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"rounded-xl border bg-white p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-700 mb-4",children:"Export Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-neutral-500",children:"Client"}),e.jsxs(N,{value:o,onValueChange:t=>w(t==="all"?"":t),children:[e.jsx(y,{className:"mt-1",children:e.jsx(f,{placeholder:"All clients"})}),e.jsxs(b,{children:[e.jsx(n,{value:"all",children:"All clients"}),c.map(t=>e.jsx(n,{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-neutral-500",children:"From Date"}),e.jsx(u,{type:"date",value:x,onChange:t=>E(t.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-neutral-500",children:"To Date"}),e.jsx(u,{type:"date",value:m,onChange:t=>T(t.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-neutral-500",children:"Status"}),e.jsxs(N,{value:v,onValueChange:t=>_(t==="any"?"":t),children:[e.jsx(y,{className:"mt-1",children:e.jsx(f,{})}),e.jsxs(b,{children:[e.jsx(n,{value:"any",children:"Any status"}),e.jsx(n,{value:"approved",children:"Approved"}),e.jsx(n,{value:"pending_review",children:"Pending Review"}),e.jsx(n,{value:"exported",children:"Already Exported"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"rounded-xl border bg-white p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50 text-blue-600",children:e.jsx(V,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-900",children:"Tally Prime XML"}),e.jsx("p",{className:"text-xs text-neutral-500",children:"Vouchers, GST ledgers, bill allocations"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(r,{className:"text-xs text-neutral-500",children:"Tally Company Name"}),e.jsx(u,{value:j,onChange:t=>D(t.target.value),placeholder:"My Company",className:"mt-1"})]}),e.jsxs("p",{className:"text-xs text-neutral-400 mb-4",children:["Import via ",e.jsx("span",{className:"font-medium text-neutral-600",children:"Gateway of Tally → Import Data"})]}),e.jsxs(C,{onClick:L,disabled:l,className:"w-full gap-2",children:[e.jsx(g,{className:"h-4 w-4"}),l?"Exporting…":"Export Tally XML"]})]}),e.jsxs("div",{className:"rounded-xl border bg-white p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-50 text-emerald-600",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-900",children:"CSV Export"}),e.jsx("p",{className:"text-xs text-neutral-500",children:"Spreadsheets and other accounting software"})]})]}),e.jsx("p",{className:"text-xs text-neutral-400 mb-4",children:"All invoice fields including line items, GST breakdown, and client details exported as flat CSV rows."}),e.jsxs(C,{variant:"outline",onClick:F,disabled:l,className:"w-full gap-2",children:[e.jsx(g,{className:"h-4 w-4"}),l?"Exporting…":"Export CSV"]})]})]})]})}export{G as default};
