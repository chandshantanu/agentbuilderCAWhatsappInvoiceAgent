import{r,z as c,s as e,X as v}from"./index-Bp_UmaCL.js";import{I as w,B as y}from"./input-GzHbweEW.js";import{B as m}from"./badge-BsIsCzmH.js";import{L as u}from"./loader-2-B7eL5lYw.js";import{I as C}from"./instagram-DmxKHDe2.js";import{M as k}from"./message-circle-DHGaqNaA.js";import{P as I}from"./plus-CPAcQCsh.js";import{S as T}from"./shield-AKBPkDLF.js";import"./index-CvZeWDWn.js";function K({config:M}){const[n,i]=r.useState([]),[l,d]=r.useState(""),[t,p]=r.useState(null),[g,j]=r.useState(!0),[f,o]=r.useState(!1);r.useEffect(()=>{Promise.all([c.get("/api/settings/triggers").then(s=>{var a;return i(((a=s.data)==null?void 0:a.triggers)||[])}),c.get("/api/instagram/status").then(s=>p(s.data))]).catch(console.error).finally(()=>j(!1))},[]);const x=()=>{if(!l.trim()||n.includes(l.trim().toLowerCase()))return;const s=[...n,l.trim().toLowerCase()];i(s),d(""),h(s)},N=s=>{const a=n.filter(b=>b!==s);i(a),h(a)},h=async s=>{o(!0);try{await c.put("/api/settings/triggers",{triggers:s})}catch(a){console.error("Save triggers failed:",a)}finally{o(!1)}};return g?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(u,{className:"w-6 h-6 animate-spin text-neutral-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-5",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-pink-500"}),"Instagram Connection"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Status"}),e.jsx(m,{className:t!=null&&t.connected?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700",children:t!=null&&t.connected?"Connected":"Disconnected"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Total Conversations"}),e.jsx("span",{className:"text-sm font-medium text-neutral-900",children:(t==null?void 0:t.total_conversations)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Total Messages"}),e.jsx("span",{className:"text-sm font-medium text-neutral-900",children:(t==null?void 0:t.total_messages)||0})]}),(t==null?void 0:t.webhook_url)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs text-neutral-500",children:"Webhook URL"}),e.jsx("div",{className:"bg-neutral-50 rounded-lg p-2 mt-1",children:e.jsx("code",{className:"text-xs text-neutral-700 break-all",children:t.webhook_url})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-5",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-blue-500"}),"Comment Keyword Triggers",f&&e.jsx(u,{className:"w-4 h-4 animate-spin text-neutral-400"})]}),e.jsx("p",{className:"text-sm text-neutral-500 mb-4",children:"When a comment contains any of these keywords, the AI will automatically reply and initiate a DM conversation."}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(w,{value:l,onChange:s=>d(s.target.value),placeholder:"Add keyword (e.g. price, available, buy)",onKeyDown:s=>s.key==="Enter"&&x()}),e.jsx(y,{onClick:x,disabled:!l.trim(),children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.length===0?e.jsx("p",{className:"text-sm text-neutral-400",children:"No triggers configured. All purchase-intent comments will be handled by AI."}):n.map(s=>e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1 px-3 py-1",children:[s,e.jsx("button",{onClick:()=>N(s),className:"ml-1 hover:text-red-500",children:e.jsx(v,{className:"w-3 h-3"})})]},s))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-5",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-green-500"}),"Rate Limiting"]}),e.jsx("p",{className:"text-sm text-neutral-500 mb-3",children:"Built-in rate limiting protects your Instagram account from API limits."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Max DMs per hour"}),e.jsx("span",{className:"text-sm font-medium text-neutral-900",children:"150"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Max DMs per minute"}),e.jsx("span",{className:"text-sm font-medium text-neutral-900",children:"15"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Protection"}),e.jsx(m,{className:"bg-emerald-100 text-emerald-700",children:"Active"})]})]})]})]})}export{K as default};
