import{r,z as d,s as e,l as B,P as y,X as E}from"./index-Bp_UmaCL.js";import{B as c,I as n}from"./input-GzHbweEW.js";import{B as h}from"./badge-BsIsCzmH.js";import{U as R}from"./upload-V_FkRrdv.js";import{P as L}from"./plus-CPAcQCsh.js";import{S as A}from"./search-hwF9FksX.js";import{L as b}from"./loader-2-B7eL5lYw.js";import{P as $}from"./pencil-BHU7Umvg.js";import{T}from"./trash-2-DMkfF4m9.js";import{C as F}from"./check-DoRmBi-x.js";import"./index-CvZeWDWn.js";function Z({config:M}){const[x,w]=r.useState([]),[k,p]=r.useState(!0),[u,C]=r.useState(""),[S,i]=r.useState(!1),[m,j]=r.useState(null),[g,f]=r.useState(!1),[a,l]=r.useState({name:"",description:"",price:0,currency:"INR",category:"",image_url:"",buy_link:"",in_stock:!0,tags:""}),o=r.useCallback(()=>{p(!0),d.get(`/api/products?search=${u}`).then(s=>{var t;return w(((t=s.data)==null?void 0:t.data)||[])}).catch(console.error).finally(()=>p(!1))},[u]);r.useEffect(()=>{o()},[o]);const P=()=>{j(null),l({name:"",description:"",price:0,currency:"INR",category:"",image_url:"",buy_link:"",in_stock:!0,tags:""}),i(!0)},_=s=>{var t;j(s),l({name:s.name,description:s.description,price:s.price,currency:s.currency,category:s.category,image_url:s.image_url,buy_link:s.buy_link,in_stock:s.in_stock,tags:((t=s.tags)==null?void 0:t.join(", "))||""}),i(!0)},I=async()=>{f(!0);try{const s={...a,tags:a.tags.split(",").map(t=>t.trim()).filter(Boolean)};m?await d.put(`/api/products/${m.id}`,s):await d.post("/api/products",s),i(!1),o()}catch(s){console.error("Save failed:",s)}finally{f(!1)}},U=async s=>{if(confirm("Delete this product?"))try{await d.delete(`/api/products/${s}`),o()}catch(t){console.error("Delete failed:",t)}},D=async s=>{var v;const t=(v=s.target.files)==null?void 0:v[0];if(!t)return;const N=new FormData;N.append("file",t);try{await d.post("/api/products/bulk-upload",N,{headers:{"Content-Type":"multipart/form-data"}}),o()}catch(z){console.error("Upload failed:",z)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-blue-500"}),"Product Catalog",e.jsx(h,{variant:"secondary",children:x.length})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".csv",onChange:D,className:"hidden"}),e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("span",{children:[e.jsx(R,{className:"w-4 h-4 mr-1"})," CSV Upload"]})})]}),e.jsxs(c,{size:"sm",onClick:P,children:[e.jsx(L,{className:"w-4 h-4 mr-1"})," Add Product"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),e.jsx(n,{placeholder:"Search products...",value:u,onChange:s=>C(s.target.value),className:"pl-9"})]}),k?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(b,{className:"w-6 h-6 animate-spin text-neutral-400"})}):x.length===0?e.jsxs("div",{className:"text-center py-12 text-neutral-500",children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-3 text-neutral-300"}),e.jsx("p",{className:"font-medium",children:"No products yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Add products to your catalog for the AI agent to recommend."})]}):e.jsx("div",{className:"bg-white rounded-xl border border-neutral-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 font-medium text-neutral-600",children:"Product"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-neutral-600",children:"Price"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-neutral-600",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-neutral-600",children:"Stock"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-neutral-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-100",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-neutral-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:"",className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-neutral-100 flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-neutral-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-neutral-900",children:s.name}),e.jsx("p",{className:"text-xs text-neutral-500 truncate max-w-[200px]",children:s.description})]})]})}),e.jsxs("td",{className:"px-4 py-3 text-neutral-900 font-medium",children:[s.currency==="INR"?"₹":"$",s.price.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(h,{variant:"outline",children:s.category||"Uncategorized"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(h,{className:s.in_stock?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700",children:s.in_stock?"In Stock":"Out of Stock"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>_(s),children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"icon",className:"w-8 h-8 text-red-500",onClick:()=>U(s.id),children:e.jsx(T,{className:"w-4 h-4"})})]})})]},s.id))})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>i(!1),children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:m?"Edit Product":"Add Product"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>i(!1),children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Name *"}),e.jsx(n,{value:a.name,onChange:s=>l(t=>({...t,name:s.target.value})),placeholder:"Product name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:s=>l(t=>({...t,description:s.target.value})),placeholder:"Product description...",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Price"}),e.jsx(n,{type:"number",value:a.price,onChange:s=>l(t=>({...t,price:parseFloat(s.target.value)||0}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Currency"}),e.jsxs("select",{value:a.currency,onChange:s=>l(t=>({...t,currency:s.target.value})),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg text-sm",children:[e.jsx("option",{value:"INR",children:"INR (₹)"}),e.jsx("option",{value:"USD",children:"USD ($)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Category"}),e.jsx(n,{value:a.category,onChange:s=>l(t=>({...t,category:s.target.value})),placeholder:"e.g. Dresses, Electronics"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Image URL"}),e.jsx(n,{value:a.image_url,onChange:s=>l(t=>({...t,image_url:s.target.value})),placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Buy Link"}),e.jsx(n,{value:a.buy_link,onChange:s=>l(t=>({...t,buy_link:s.target.value})),placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Tags (comma separated)"}),e.jsx(n,{value:a.tags,onChange:s=>l(t=>({...t,tags:s.target.value})),placeholder:"sale, new-arrival, festive"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.in_stock,onChange:s=>l(t=>({...t,in_stock:s.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm text-neutral-700",children:"In Stock"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(c,{variant:"outline",className:"flex-1",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(c,{className:"flex-1",onClick:I,disabled:g||!a.name,children:[g?e.jsx(b,{className:"w-4 h-4 animate-spin mr-1"}):e.jsx(F,{className:"w-4 h-4 mr-1"}),m?"Update":"Create"]})]})]})})]})}export{Z as default};
