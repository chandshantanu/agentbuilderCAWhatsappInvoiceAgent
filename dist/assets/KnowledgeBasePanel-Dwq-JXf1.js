import{r as a,z as d,s as e,F as _,X as I}from"./index-Bp_UmaCL.js";import{B as r,I as u}from"./input-GzHbweEW.js";import{B as b}from"./badge-BsIsCzmH.js";import{B as L}from"./book-open-BlF9Aztt.js";import{U as q}from"./upload-V_FkRrdv.js";import{P as R}from"./plus-CPAcQCsh.js";import{S as $}from"./search-hwF9FksX.js";import{L as y}from"./loader-2-B7eL5lYw.js";import{P as K}from"./pencil-BHU7Umvg.js";import{T as M}from"./trash-2-DMkfF4m9.js";import{C as O}from"./check-DoRmBi-x.js";import"./index-CvZeWDWn.js";const w=["faq","returns","shipping","brand_story","policies","general","uploaded"];function le({config:G}){const[p,C]=a.useState([]),[k,g]=a.useState(!0),[m,A]=a.useState(""),[x,S]=a.useState(""),[B,n]=a.useState(!1),[h,f]=a.useState(null),[j,v]=a.useState(!1),[l,i]=a.useState({title:"",content:"",category:"general",tags:""}),c=a.useCallback(()=>{g(!0);const t=new URLSearchParams;m&&t.set("search",m),x&&t.set("category",x),d.get(`/api/knowledge-base?${t}`).then(s=>{var o;return C(((o=s.data)==null?void 0:o.data)||[])}).catch(console.error).finally(()=>g(!1))},[m,x]);a.useEffect(()=>{c()},[c]);const U=()=>{f(null),i({title:"",content:"",category:"general",tags:""}),n(!0)},E=t=>{var s;f(t),i({title:t.title,content:t.content,category:t.category,tags:((s=t.tags)==null?void 0:s.join(", "))||""}),n(!0)},F=async()=>{v(!0);try{const t={...l,tags:l.tags.split(",").map(s=>s.trim()).filter(Boolean)};h?await d.put(`/api/knowledge-base/${h.id}`,t):await d.post("/api/knowledge-base",t),n(!1),c()}catch(t){console.error("Save failed:",t)}finally{v(!1)}},z=async t=>{if(confirm("Delete this article?"))try{await d.delete(`/api/knowledge-base/${t}`),c()}catch(s){console.error("Delete failed:",s)}},P=async t=>{var N;const s=(N=t.target.files)==null?void 0:N[0];if(!s)return;const o=new FormData;o.append("file",s);try{await d.post("/api/knowledge-base/bulk-upload",o,{headers:{"Content-Type":"multipart/form-data"}}),c()}catch(D){console.error("Upload failed:",D)}},T=t=>({faq:"bg-blue-100 text-blue-700",returns:"bg-orange-100 text-orange-700",shipping:"bg-purple-100 text-purple-700",brand_story:"bg-pink-100 text-pink-700",policies:"bg-neutral-100 text-neutral-700",uploaded:"bg-cyan-100 text-cyan-700"})[t]||"bg-neutral-100 text-neutral-700";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-indigo-500"}),"Knowledge Base",e.jsx(b,{variant:"secondary",children:p.length})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".txt,.pdf",onChange:P,className:"hidden"}),e.jsx(r,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("span",{children:[e.jsx(q,{className:"w-4 h-4 mr-1"})," Upload File"]})})]}),e.jsxs(r,{size:"sm",onClick:U,children:[e.jsx(R,{className:"w-4 h-4 mr-1"})," Add Article"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),e.jsx(u,{placeholder:"Search articles...",value:m,onChange:t=>A(t.target.value),className:"pl-9"})]}),e.jsxs("select",{value:x,onChange:t=>S(t.target.value),className:"px-3 py-2 border border-neutral-300 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),w.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")},t))]})]}),k?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(y,{className:"w-6 h-6 animate-spin text-neutral-400"})}):p.length===0?e.jsxs("div",{className:"text-center py-12 text-neutral-500",children:[e.jsx(_,{className:"w-12 h-12 mx-auto mb-3 text-neutral-300"}),e.jsx("p",{className:"font-medium",children:"No articles yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Add FAQs, return policies, and brand info so the AI can answer customer questions."})]}):e.jsx("div",{className:"space-y-3",children:p.map(t=>e.jsx("div",{className:"bg-white rounded-xl border border-neutral-200 p-4 hover:bg-neutral-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-neutral-900 truncate",children:t.title}),e.jsx(b,{className:T(t.category),children:t.category.replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-neutral-500 line-clamp-2",children:t.content})]}),e.jsxs("div",{className:"flex gap-1 ml-3",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>E(t),children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"w-8 h-8 text-red-500",onClick:()=>z(t.id),children:e.jsx(M,{className:"w-4 h-4"})})]})]})},t.id))}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>n(!1),children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:h?"Edit Article":"Add Article"}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>n(!1),children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Title *"}),e.jsx(u,{value:l.title,onChange:t=>i(s=>({...s,title:t.target.value})),placeholder:"Article title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Content *"}),e.jsx("textarea",{value:l.content,onChange:t=>i(s=>({...s,content:t.target.value})),placeholder:"Article content...",rows:8,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Category"}),e.jsx("select",{value:l.category,onChange:t=>i(s=>({...s,category:t.target.value})),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg text-sm",children:w.filter(t=>t!=="uploaded").map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:"Tags (comma separated)"}),e.jsx(u,{value:l.tags,onChange:t=>i(s=>({...s,tags:t.target.value})),placeholder:"shipping, returns"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(r,{variant:"outline",className:"flex-1",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(r,{className:"flex-1",onClick:F,disabled:j||!l.title||!l.content,children:[j?e.jsx(y,{className:"w-4 h-4 animate-spin mr-1"}):e.jsx(O,{className:"w-4 h-4 mr-1"}),h?"Update":"Create"]})]})]})})]})}export{le as default};
