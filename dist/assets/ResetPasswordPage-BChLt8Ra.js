import{u as S,o as P,q as C,r as t,s as e,v as g}from"./index-Bp_UmaCL.js";function R(){const{config:o}=S(),{updatePassword:h,session:l,isLoading:i}=P(),p=C(),[a,f]=t.useState(""),[c,b]=t.useState(""),[n,r]=t.useState(""),[u,m]=t.useState(!1),[w,y]=t.useState(!1),[x,j]=t.useState(!1),d=(o==null?void 0:o.branding)||{},N=d.primary_color||"#2563eb";t.useEffect(()=>{if(i)return;if(l){j(!0),r("");return}const s=setTimeout(()=>{l||r("Recovery link expired or invalid. Please request a new reset link.")},8e3);return()=>clearTimeout(s)},[l,i]);const v=async s=>{if(s.preventDefault(),r(""),a.length<6){r("Password must be at least 6 characters");return}if(a!==c){r("Passwords do not match");return}m(!0);try{await h(a),y(!0),setTimeout(()=>p("/login"),2e3)}catch(k){r(k.message||"Failed to reset password")}finally{m(!1)}};return i||!x&&!n?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Verifying recovery link..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[d.logo_url&&e.jsx("img",{src:d.logo_url,alt:"",className:"h-10 w-auto mx-auto mb-3"}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Set new password"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter your new password below"})]}),w?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Password updated"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting to login..."})]}):e.jsxs("form",{onSubmit:v,className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm space-y-4",children:[n&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 rounded-lg p-3",children:[n,n.includes("expired")&&e.jsx(g,{to:"/forgot-password",className:"block mt-2 font-medium underline",children:"Request new reset link"})]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:a,onChange:s=>f(s.target.value),required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"At least 6 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",value:c,onChange:s=>b(s.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirm your new password"})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full py-2.5 rounded-lg text-white font-medium text-sm disabled:opacity-50",style:{backgroundColor:N},children:u?"Updating...":"Update Password"})]})]}),e.jsx("p",{className:"text-center mt-6",children:e.jsx(g,{to:"/login",className:"text-sm text-gray-400 hover:text-gray-600",children:"Back to login"})})]})})}export{R as default};
